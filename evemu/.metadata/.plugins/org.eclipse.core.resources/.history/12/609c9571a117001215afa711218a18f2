

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

import javax.swing.JOptionPane;

public class DBConnect {
	
	private static Connection con = null;
	private static Statement statement = null;
	private static ResultSet rs = null;
	private static int updateQuerry = 0;
	private static String url = "jdbc:mysql://"+ Settings.server + "/" + Settings.dbName;
	
	private static void OpenConnection() {
		try {
			Class.forName("com.mysql.jdbc.Driver").newInstance();
			con = DriverManager.getConnection(url, Settings.user, Settings.pass);
			if(!con.isClosed())
				System.out.println("Connected to database!");
		} 
		catch (Exception e) {
			// TODO Auto-generated catch block
			System.err.println("Exception: " + e.getMessage());
		}
	}
	
	private static void CloseConnection() {
		try {
	        if(con != null)
	          con.close();
	    } 
	    catch(SQLException e) {}
	}
	
	public static void TestConnection() {
		try {
			OpenConnection();
			if(!con.isClosed())
				JOptionPane.showMessageDialog(null, "Connected to " + Settings.dbName, "Test Connection ", JOptionPane.INFORMATION_MESSAGE);
		} 
		catch (Exception e) {
			// TODO Auto-generated catch block
			JOptionPane.showMessageDialog(null, "Exception: " + e.getMessage(), "Error ", JOptionPane.ERROR_MESSAGE);
			System.err.println("Exception: " + e.getMessage());
		}
		finally {
			CloseConnection();
	    }
	}
	
	public static void SimpleQuerry(String querryString) {
		try {
			OpenConnection();
			
			statement = con.createStatement();
			updateQuerry = statement.executeUpdate(querryString);
			
			if(updateQuerry != 0){
				System.out.println("Sql querry executed!");
			}
			
			statement.close();
			CloseConnection();
			
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}
	
	public static void AdvancedQuerry(String querryString) {
		try {
			OpenConnection();
			
			statement = con.createStatement();
			updateQuerry = statement.executeUpdate(querryString);
			
			if(updateQuerry != 0){
				System.out.println("Sql querry executed!");
			}
			
			statement.close();
			CloseConnection();
			
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}
}
